"""
Data Processing
"""
import MySQLdb

def data_process():

    category_list = ['Unknown', 'Communication', 'Social', 'Tools', 'Shopping', 'Travel', 'Productivity', 'Weather', 'News', 'Media', 'Photography', 'Finance', 'Casual', 'Arcade', 'Health', 'Entertainment', 'Books', 'Personalization', 'Lifestyle', 'Music', 'Strategy', 'Business', 'Comics', 'Family', 'Transportation', 'Card', 'Word', 'Libraries', 'Board', 'Sports', 'Racing', 'Action', 'Simulation', 'Puzzle', 'Education', 'Role', 'Trivia', 'Medical', 'Adventure', 'Educational']

    cao = ['Unknown_morning', 'Unknown_afternoon', 'Unknown_evening', 'Communication_morning', 'Communication_afternoon', 'Communication_evening', 'Social_morning', 'Social_afternoon', 'Social_evening', 'Tools_morning', 'Tools_afternoon', 'Tools_evening', 'Shopping_morning', 'Shopping_afternoon', 'Shopping_evening', 'Travel_morning', 'Travel_afternoon', 'Travel_evening', 'Productivity_morning', 'Productivity_afternoon', 'Productivity_evening', 'Weather_morning', 'Weather_afternoon', 'Weather_evening', 'News_morning', 'News_afternoon', 'News_evening', 'Media_morning', 'Media_afternoon', 'Media_evening', 'Photography_morning', 'Photography_afternoon', 'Photography_evening', 'Finance_morning', 'Finance_afternoon', 'Finance_evening', 'Casual_morning', 'Casual_afternoon', 'Casual_evening', 'Arcade_morning', 'Arcade_afternoon', 'Arcade_evening', 'Health_morning', 'Health_afternoon', 'Health_evening', 'Entertainment_morning', 'Entertainment_afternoon', 'Entertainment_evening', 'Books_morning', 'Books_afternoon', 'Books_evening', 'Personalization_morning', 'Personalization_afternoon', 'Personalization_evening', 'Lifestyle_morning', 'Lifestyle_afternoon', 'Lifestyle_evening', 'Music_morning', 'Music_afternoon', 'Music_evening', 'Strategy_morning', 'Strategy_afternoon', 'Strategy_evening', 'Business_morning', 'Business_afternoon', 'Business_evening', 'Comics_morning', 'Comics_afternoon', 'Comics_evening', 'Family_morning', 'Family_afternoon', 'Family_evening', 'Transportation_morning', 'Transportation_afternoon', 'Transportation_evening', 'Card_morning', 'Card_afternoon', 'Card_evening', 'Word_morning', 'Word_afternoon', 'Word_evening', 'Libraries_morning', 'Libraries_afternoon', 'Libraries_evening', 'Board_morning', 'Board_afternoon', 'Board_evening', 'Sports_morning', 'Sports_afternoon', 'Sports_evening', 'Racing_morning', 'Racing_afternoon', 'Racing_evening', 'Action_morning', 'Action_afternoon', 'Action_evening', 'Simulation_morning', 'Simulation_afternoon', 'Simulation_evening', 'Puzzle_morning', 'Puzzle_afternoon', 'Puzzle_evening', 'Education_morning', 'Education_afternoon', 'Education_evening', 'Role_morning', 'Role_afternoon', 'Role_evening', 'Trivia_morning', 'Trivia_afternoon', 'Trivia_evening', 'Medical_morning', 'Medical_afternoon', 'Medical_evening', 'Adventure_morning', 'Adventure_afternoon', 'Adventure_evening', 'Educational_morning', 'Educational_afternoon', 'Educational_evening']

    time_of_day = ['morning', 'afternoon', 'evening']

    connection = MySQLdb.connect('localhost', 'root', '', 'mobile_analysis')
    t = connection.cursor()

    sql1 = "SELECT DISTINCT device_id from user_app_duration"
    t.execute(sql1)
    user_list = t.fetchall()

    for user in user_list:
        sql2 = "SELECT * FROM user_category WHERE device_id='%s'"%(user[0])
        t.execute(sql2)
        category_info = t.fetchall()
        all_info = {c:0.0 for c in cao}
        for info in category_info:
            for time in time_of_day:
                name = info[1] + '_' + time
                digits = info[time_of_day.index(time)+3]
                all_info[name] = digits
        sql3 = "INSERT INTO final_result (device_id, Unknown_morning, Unknown_afternoon, Unknown_evening, Communication_morning, Communication_afternoon, Communication_evening, Social_morning, Social_afternoon, Social_evening, Tools_morning, Tools_afternoon, Tools_evening, Shopping_morning, Shopping_afternoon, Shopping_evening, Travel_morning, Travel_afternoon, Travel_evening, Productivity_morning, Productivity_afternoon, Productivity_evening, Weather_morning, Weather_afternoon, Weather_evening, News_morning, News_afternoon, News_evening, Media_morning, Media_afternoon, Media_evening, Photography_morning, Photography_afternoon, Photography_evening, Finance_morning, Finance_afternoon, Finance_evening, Casual_morning, Casual_afternoon, Casual_evening, Arcade_morning, Arcade_afternoon, Arcade_evening, Health_morning, Health_afternoon, Health_evening, Entertainment_morning, Entertainment_afternoon, Entertainment_evening, Books_morning, Books_afternoon, Books_evening, Personalization_morning, Personalization_afternoon, Personalization_evening, Lifestyle_morning, Lifestyle_afternoon, Lifestyle_evening, Music_morning, Music_afternoon, Music_evening, Strategy_morning, Strategy_afternoon, Strategy_evening, Business_morning, Business_afternoon, Business_evening, Comics_morning, Comics_afternoon, Comics_evening, Family_morning, Family_afternoon, Family_evening, Transportation_morning, Transportation_afternoon, Transportation_evening, Card_morning, Card_afternoon, Card_evening, Word_morning, Word_afternoon, Word_evening, Libraries_morning, Libraries_afternoon, Libraries_evening, Board_morning, Board_afternoon, Board_evening, Sports_morning, Sports_afternoon, Sports_evening, Racing_morning, Racing_afternoon, Racing_evening, Action_morning, Action_afternoon, Action_evening, Simulation_morning, Simulation_afternoon, Simulation_evening, Puzzle_morning, Puzzle_afternoon, Puzzle_evening, Education_morning, Education_afternoon, Education_evening, Role_morning, Role_afternoon, Role_evening, Trivia_morning, Trivia_afternoon, Trivia_evening, Medical_morning, Medical_afternoon, Medical_evening, Adventure_morning, Adventure_afternoon, Adventure_evening, Educational_morning, Educational_afternoon, Educational_evening) VALUES('%s', %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f)"%(user[0], all_info['Unknown_morning'], all_info['Unknown_afternoon'], all_info['Unknown_evening'], all_info['Communication_morning'], all_info['Communication_afternoon'], all_info['Communication_evening'], all_info['Social_morning'], all_info['Social_afternoon'], all_info['Social_evening'], all_info['Tools_morning'], all_info['Tools_afternoon'], all_info['Tools_evening'], all_info['Shopping_morning'], all_info['Shopping_afternoon'], all_info['Shopping_evening'], all_info['Travel_morning'], all_info['Travel_afternoon'], all_info['Travel_evening'], all_info['Productivity_morning'], all_info['Productivity_afternoon'], all_info['Productivity_evening'], all_info['Weather_morning'], all_info['Weather_afternoon'], all_info['Weather_evening'], all_info['News_morning'], all_info['News_afternoon'], all_info['News_evening'], all_info['Media_morning'], all_info['Media_afternoon'], all_info['Media_evening'], all_info['Photography_morning'], all_info['Photography_afternoon'], all_info['Photography_evening'], all_info['Finance_morning'], all_info['Finance_afternoon'], all_info['Finance_evening'], all_info['Casual_morning'], all_info['Casual_afternoon'], all_info['Casual_evening'], all_info['Arcade_morning'], all_info['Arcade_afternoon'], all_info['Arcade_evening'], all_info['Health_morning'], all_info['Health_afternoon'], all_info['Health_evening'], all_info['Entertainment_morning'], all_info['Entertainment_afternoon'], all_info['Entertainment_evening'], all_info['Books_morning'], all_info['Books_afternoon'], all_info['Books_evening'], all_info['Personalization_morning'], all_info['Personalization_afternoon'], all_info['Personalization_evening'], all_info['Lifestyle_morning'], all_info['Lifestyle_afternoon'], all_info['Lifestyle_evening'], all_info['Music_morning'], all_info['Music_afternoon'], all_info['Music_evening'], all_info['Strategy_morning'], all_info['Strategy_afternoon'], all_info['Strategy_evening'], all_info['Business_morning'], all_info['Business_afternoon'], all_info['Business_evening'], all_info['Comics_morning'], all_info['Comics_afternoon'], all_info['Comics_evening'], all_info['Family_morning'], all_info['Family_afternoon'], all_info['Family_evening'], all_info['Transportation_morning'], all_info['Transportation_afternoon'], all_info['Transportation_evening'], all_info['Card_morning'], all_info['Card_afternoon'], all_info['Card_evening'], all_info['Word_morning'], all_info['Word_afternoon'], all_info['Word_evening'], all_info['Libraries_morning'], all_info['Libraries_afternoon'], all_info['Libraries_evening'], all_info['Board_morning'], all_info['Board_afternoon'], all_info['Board_evening'], all_info['Sports_morning'], all_info['Sports_afternoon'], all_info['Sports_evening'], all_info['Racing_morning'], all_info['Racing_afternoon'], all_info['Racing_evening'], all_info['Action_morning'], all_info['Action_afternoon'], all_info['Action_evening'], all_info['Simulation_morning'], all_info['Simulation_afternoon'], all_info['Simulation_evening'], all_info['Puzzle_morning'], all_info['Puzzle_afternoon'], all_info['Puzzle_evening'], all_info['Education_morning'], all_info['Education_afternoon'], all_info['Education_evening'], all_info['Role_morning'], all_info['Role_afternoon'], all_info['Role_evening'], all_info['Trivia_morning'], all_info['Trivia_afternoon'], all_info['Trivia_evening'], all_info['Medical_morning'], all_info['Medical_afternoon'], all_info['Medical_evening'], all_info['Adventure_morning'], all_info['Adventure_afternoon'], all_info['Adventure_evening'], all_info['Educational_morning'], all_info['Educational_afternoon'], all_info['Educational_evening'])

        t.execute(sql3)

    connection.commit()


if __name__ == '__main__':
    data_process()
        

            

        

